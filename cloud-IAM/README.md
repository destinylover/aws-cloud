## IAM 이해 및 실습 정리

이번에는 AWS 리소스에 대한 접근을 어떻게 통제하는지, 그 핵심인 IAM(Identity and Access Management)에 대해 학습하고 정리했다.  
처음엔 단순히 “접근 제어”라고만 생각했는데, 실제로 IAM을 설정해보면서 인증과 인가가 어떻게 나뉘는지, 그리고 사용자, 그룹, 정책이 어떻게 연결되는지를 이해하게 되었다.

---

IAM이란?

IAM은 AWS 리소스에 대한 접근 제어를 담당하는 서비스다.  
사용자마다 어떤 서비스에 접근할 수 있는지를 설정하고, 그것을 그룹이나 정책 단위로 관리할 수 있게 해준다.  
보안이 중요한 클라우드 환경에서는 필수적으로 사용해야 하는 기능 중 하나다.

---

인증과 인가의 차이

이 두 개념을 확실히 구분하는 게 중요했다.

- 인증 (Authentication):  
  '너 누구냐?'를 묻는 것.  
  사용자 이름과 비밀번호, MFA(다중 인증), 액세스 키 등을 통해 신원을 증명한다.  
  로그인이나 API 호출 시 사용된다.

- 인가 (Authorization):  
  '무슨 작업을 할 수 있는데?'를 확인하는 것.  
  인증된 사용자가 어떤 AWS 리소스에 대해 어떤 작업을 할 수 있는지를 권한으로 통제한다.  
  IAM 정책을 통해 정의된다.

AWS에서는 이 두 절차가 명확히 분리되어 있다. 인증 없이는 인가도 없고, 인가가 없으면 아무 작업도 할 수 없다.

---

루트 사용자와 IAM 사용자

AWS 계정을 만들면 루트 사용자가 하나 생긴다.  
이 사용자는 말 그대로 모든 권한을 가진 관리자이며, 동시에 보안상 가장 위험한 존재다.

루트 사용자는 계정 생성 시 자동으로 만들어지고, 모든 리소스에 대한 무제한 권한을 가진다.  
하지만 실제 운영에는 사용하지 않는 것이 원칙이다.  
루트 계정은 결제, 계정 설정 등 특수한 경우에만 사용하고, 리소스 접근은 별도의 사용자 계정으로 나누는 것이 안전하다.

그래서 IAM 사용자를 만들어서 운영하게 된다.  
IAM 사용자는 루트 계정이 생성하며, 역할(role)과 정책(policy)에 따라 필요한 권한만 갖는다.  
운영이나 개발 작업은 IAM 사용자로 나눠서 하는 것이 기본이다.

마치 리눅스에서 root 계정으로 직접 작업하는 건 위험해서 일반 사용자로 권한을 분리하듯,  
AWS에서도 같은 개념으로 이해하면 된다.

---

IAM 그룹 활용하기

여러 사용자에게 같은 권한을 주고 싶을 때 그룹을 쓰면 관리가 훨씬 편해진다.

사용자마다 개별 권한을 지정하면 나중에 관리가 복잡해지기 때문에, 사용자들을 역할 단위로 그룹에 묶고, 그룹에만 정책을 할당하면 훨씬 깔끔하게 운영할 수 있다.

예를 들어:

- Dev 그룹에는 EC2, S3만 접근 가능한 권한
- Admin 그룹에는 VPC, RDS, IAM 포함 전체 권한

이런 식으로 그룹을 중심으로 권한을 구성하는 방식이 실무에서도 기본이다.

---


### 다중 요소 인증(MFA) 설정하기

루트 계정은 권한이 막강하기 때문에, 로그인 보안을 강화할 필요가 있다.  
비밀번호만으로 접근 가능한 상태는 위험할 수 있어, MFA(다중 인증)를 설정했다.

일반적으로 사용하는 Google Authenticator 앱을 설치하고,  
AWS 콘솔에서 MFA 설정을 진행했다. QR 코드를 스캔하고,  
앱에 표시되는 6자리 코드를 두 번 입력하면 설정이 완료된다.

이제 루트 계정 로그인 시 추가 인증이 요구되며,  
비밀번호 유출만으로는 접근이 불가능하다.

보안 자격 증명 관리 화면을 열고 MFA를 활성화 시켰다.
![iam4](https://github.com/user-attachments/assets/6bf8e334-940e-4af2-a017-fc4681c63d03)
다음 기기관리명을 적어줍니다. 나중에도 어떤 기기라는걸 알아볼 수 있도록 했다.
![iam5](https://github.com/user-attachments/assets/66f983d5-ea09-4fbe-b035-a8b063c49637)

![iam7](https://github.com/user-attachments/assets/78d4e04a-140e-437b-b535-4d7b881f0502)

이제 계정 비밀번호 유출만으로 핵과금 사태를 맞이할 위험은 사라졌다.

### 일반 사용자(IAM) 계정 생성하기

루트 계정 대신 사용할 일반 사용자 계정을 생성하기 위해 IAM 대시보드로 이동했다.

![iam8](https://github.com/user-attachments/assets/71e71084-357d-4966-9f47-41ae9d2770e6)

IAM 콘솔에서 '액세스 관리' 메뉴로 들어가, 사용자 탭을 선택한 뒤 새 사용자를 추가했다.

![iam9](https://github.com/user-attachments/assets/1c07e9c6-45ff-4f5d-aee3-e7302e24045e)

사용자 생성 버튼을 클릭한 후, 간단하게 계정 이름을 입력했다.  
콘솔 로그인 권한을 부여하고, IAM 사용자 유형을 선택했다.  
암호는 자동 생성 방식으로 설정했다.

![iam10](https://github.com/user-attachments/assets/59c0618a-d797-48b1-8435-4f93b65af40e)


![iam13](https://github.com/user-attachments/assets/eed6ac38-ee86-4940-b69b-37db7fed9b15)

모든 설정을 마치고 사용자 계정을 생성했다.



![iam14](https://github.com/user-attachments/assets/93989745-7de7-486d-98c4-9dda6b9f7cf5)

이제 루트 계정에서 로그아웃한 뒤, 새로 만든 사용자 계정으로 콘솔에 로그인해본다.

![iam17](https://github.com/user-attachments/assets/e6b87e13-4e8d-405a-b170-f9c20eba3f4b)

루트 계정에서 가능했던 일부 기능들이 제한된 것을 확인할 수 있다.

### 그룹 설정하기

이제 사용자 그룹을 만들어 권한을 효율적으로 관리해본다.

먼저 IAM 사용자에서 로그아웃한 뒤, 다시 루트 계정으로 로그인했다.  
이후 IAM 대시보드에서 '사용자 그룹' 메뉴로 이동해 새로운 그룹을 생성하고, 이름을 지정했다.

![18](https://github.com/user-attachments/assets/1bfca6ba-4c06-4fda-9317-8a08f70b03e7)

이제 루트계정 산하에 있는 모든 iam계정이 나타나고 추가해주면 된다.

![20](https://github.com/user-attachments/assets/fdea2c38-48c5-43ca-8d3e-9f9bcd246f11)
그룹 설정 하단에서는 해당 그룹에 일괄적으로 적용할 권한 정책을 선택할 수 있다.  
필요한 정책을 연결한 뒤, 그룹 생성을 완료했다.

여기서는 PowerUserAccess, IAMFullAccess 2개를 부여했다.


PowerUserAccess : AWS의 모든 자원에 접근 가능.
IAMFullAccess : IAM에 대한 모든 접근 권한을 가짐.
![20](https://github.com/user-attachments/assets/5ad17f58-07dc-4c2a-b0a2-91033b276205)
![21](https://github.com/user-attachments/assets/b938c58d-00fe-46e2-9234-291b7ad9220b)

그룹 생성 이후에 사용자를 추가하려면,  
IAM 콘솔에서 해당 그룹으로 들어가 사용자만 따로 추가할 수도 있다.

![22](https://github.com/user-attachments/assets/a3d81e00-d530-4b9f-8f7d-310a0cdeb3b8)
이제 권한이 부여됐기 때문에, 다시 로그아웃한 뒤 해당 IAM 계정으로 로그인해보면  
이전과는 달리 더 많은 서비스에 접근할 수 있게 된 걸 확인할 수 있다.

![23](https://github.com/user-attachments/assets/08089860-e59c-4449-b2e7-20691ba9bebb)


실습하면서 느낀 점

처음엔 IAM 정책이 JSON이라 직관적으로 이해하기 어려웠는데,  
콘솔에서 제공하는 시각적 편집기나 AWS의 기본 템플릿을 활용하면 정책 구조가 금방 익숙해졌다.

특히 처음엔 실수로 FullAccess를 부여했는데, 이게 얼마나 위험한 일인지 실습을 통해 알 수 있었다.  
결국 중요한 건 최소 권한 원칙을 지키는 거다. 필요한 작업만 허용하고 나머지는 차단하는 방식이 가장 안전하다.

IAM은 단독 주제이기도 하지만, S3, EC2, Lambda 등 모든 AWS 서비스와 연관되기 때문에 제대로 이해해두는 게 정말 중요하다고 느꼈다.
